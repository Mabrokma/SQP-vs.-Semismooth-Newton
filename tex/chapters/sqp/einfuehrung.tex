Das SQP-Verfahren ist ein wichtiges Verfahren,
um restringierte nichlineare Probleme zu lösen.
SQP ist eine Abkürzung für sequentielle quadratische Programmierung
(englisch: Sequential Quadratic Programming).
Die Idee ist nämlich, dass Teilprobleme in Form quadratischer
Optimierungsprobleme iterativ formuliert und gelöst werden.

% TODO Erstes: Wilson im Jahr 1963
% [120] Wilson R. B.: A simplical algorithm for concave programming. PhD Thesis.
% Harvard university, Boston 1963.
% [92] Han und Powell: Algorithms 
% [41]

Wir haben im Unterkapitel~\ref{sec:newton_verfahren} über das Newton-Verfahren
gesehen, dass dieses Verfahren in jedem Iterationschritt eigentlich ein
unrestringiertes quadratisches Problem
\begin{equation}
  \min_{x \in \R^n}\ \frac{1}{2} (x-x^k)^T f''(x^k) (x-x^k)
                     + \nabla f(x^k)^T (x-x^k)
\end{equation}
löst.
Wir werden hier nochmal voraussetzen, dass $f$ zweimal differenzierbar ist.

Diese Idee werden wir auch verwenden. Aber wir lösen nicht das unrestringierte
Problem, sondern das restringierte Problem
\begin{equation}
  \min_{x \in \F}\ \frac{1}{2} (x-x^k)^T f''(x^k) (x-x^k)
                     + \nabla f(x^k)^T (x-x^k).
\end{equation}

Wir betrachen erstmal das Optimierungsproblem mit linearen
Gleichungs- und
Ungleichungsnebenbedingungen~\eqref{prob:opt_prob_mit_lin_ungl_nebenbed}.
\begin{align*}
  \min_{x \in \R^n}\ & f(x) \\
                 \nb & Ax = b \\
                     & Gx \leq r
\end{align*}

Das Teilproblem ist also
\begin{align}
  \min_{x \in \R^n}\ & \frac{1}{2} (x-x^k)^T f''(x^k) (x-x^k)
                         + \nabla f(x^k)^T (x-x^k) \\
                 \nb & A x = b \notag \\
                     & G x \leq r \notag
\end{align}%TODO erwähnen dass f(x^k) weggelassen wurde

Definieren wir $d := x - x^k$.
Dann haben wir $x = x^k + d$ und als Teilproblem
\begin{align}
  \min_{x \in \R^n}\ & \frac{1}{2} d^T f''(x^k) d
                         + \nabla f(x^k)^T d \\
                 \nb & A x^k + A d = b \label{eq:teilprob_lin_gl_nebenbed} \\
                     & G x^k + G d \leq r
\end{align}

Weil wir voraussetzen werden, dass $x^k \in \F$ ist, d.\,h.,
es gilt $A x^k = b$, können wir als Gleichungsnebenbedingung an der
Stelle~\eqref{eq:teilprob_lin_gl_nebenbed} die Gleichung $Ad = 0$ schreiben.

Wir haben also das Teilproblem
\begin{align}
  \min_{x \in \R^n}\ & \frac{1}{2} d^T f''(x^k) d
                     + \nabla f(x^k)^T d \label{prob:quad_opt_prob_in_sqp}\\
                 \nb & A d = 0 \notag \\
                     & G x^k + G d \leq r \notag
\end{align}

Nun sind wir bereit, das SQP-Verfahren zu formulieren.

\begin{algorithm}
\emph{(SQP-Verfahren)} %FIXME stop criteria
\begin{enumerate}
  \item Berechne einen zulässigen Startpunkt $x^0$ und setze $k:=0$.
  \item Berechne die Lösung $d$ des Problems~\eqref{prob:quad_opt_prob_in_sqp}.
        \label{list:quad_opt_prob} Setze $d^k := d$.
  \item Setze $x^{k+1} := x^k + d^k$ und $k := k+1$.
        $\Rightarrow$ Gehe zu Schritt~\ref{list:quad_opt_prob}
\end{enumerate}
\end{algorithm}
