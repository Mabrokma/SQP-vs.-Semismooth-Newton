Wir betrachen zuerst Optimierungsprobleme mit linearen
Gleichungs- und
Ungleichungsnebenbedingungen~\eqref{prob:opt_prob_mit_lin_ungl_nebenbed}.
\begin{align*}
  \min_{x \in \R^n}\ & f(x) \\
                 \nb & Ax = b \\
                     & Gx \leq r
\end{align*}

Das Teilproblem nach~\eqref{prob:teilprob_von_sqp_allg} sieht dann so aus:
\begin{align}
  \min_{x \in \R^n}\ & \frac{1}{2} (x-x^k)^T f''(x^k) (x-x^k)
                         + \nabla f(x^k)^T (x-x^k) \\
                 \nb & A x = b \notag \\
                     & G x \leq r \notag
\end{align}

Definieren wir $d := x - x^k$.
Dann haben wir $x = x^k + d$ und als Teilproblem
\begin{align}
  \min_{x \in \R^n}\ & \frac{1}{2} d^T f''(x^k) d
                         + \nabla f(x^k)^T d \\
                 \nb & A x^k + A d = b \label{eq:teilprob_lin_gl_nebenbed} \\
                     & G x^k + G d \leq r
\end{align}

Das ist ein quadratisches Optimierungsproblem mit linearen Restriktionen.
Wir werden im nächsten Unterkapitel sehen, wie man es lösen kann.

Weil wir voraussetzen werden, dass $x^k \in \F$ ist,
d.\,h., es gilt \mbox{$A x^k = b$}, können wir als Gleichungsnebenbedingung an
der Stelle~\eqref{eq:teilprob_lin_gl_nebenbed} die Gleichung $Ad = 0$ schreiben.
Nun sind wir bereit, das SQP-Verfahren zu formulieren.

\begin{algorithm}
\emph{(SQP-Verfahren für \eqref{prob:opt_prob_mit_lin_ungl_nebenbed},
vgl. Verfahren 6.4.1 in \cite[S.~237]{alt})}
\begin{enumerate}
  \item Wähle einen zulässigen Startpunkt $x^0$
    und eine Abbruchschranke $\varepsilon > 0$. Setze $k:=0$.
  \item Berechne die Lösung $d$ des Problems \label{list:quad_opt_prob_in_sqp}
  \begin{align}
    \min_{x \in \R^n}\ & \frac{1}{2} d^T f''(x^k) d
                       + \nabla f(x^k)^T d
                       \tag{$\text{QLU}_k$}
                       \label{prob:quad_opt_prob_in_sqp}\\
                   \nb & A d = 0 \notag \\
                       & G x^k + G d \leq r \notag
  \end{align}
    Setze $d^k := d$.
    
  \item Ist $\|d^k\| < \varepsilon \Rightarrow$ STOP.
    
  \item Setze $x^{k+1} := x^k + d^k$ und $k := k+1$.
    $\Rightarrow$ Gehe zu Schritt~\ref{list:quad_opt_prob_in_sqp}.
\end{enumerate}
\end{algorithm}

Der folgende Satz macht eine Aussage zur Konvergenzgeschwindigkeit
des Verfahrens.
\begin{theorem}
\emph{(Vgl. Satz 6.4.4 in \cite[S.~243]{alt})}\\
Sei $\xopt$ lokale Lösung von \eqref{prob:opt_prob_mit_lin_ungl_nebenbed}.
Sei $f$ auf $D$ zweimal stetig differenzierbar
und es gelte die Bedingung~\eqref{eq:hesse_matrix_pos_def_auf_kern_A}.
Dann gibt es ein $\delta > 0$, sodass das SQP-Verfahren
für jeden Startpunkt $x^0 \in B(\xopt,\delta)$
eine Folge $\{x^k\}$ definiert,
die superlinear gegen $\xopt$ konvergiert.
Ist zusätzlich $f''$ auf $D$ Lipschitz-stetig\footnote{$f''$ ist
auf $D$ Lipschitz-stetig,
falls es eine Konstante $L > 0$ mit
$\|f''(x) - f''(y)\| \leq L \|x-y\|$
für alle $x,y \in D$
gibt},
dann konvergiert $\{x^k\}$ für jeden Startpunkt $x^0 \in B(\xopt,\delta)$
quadratisch gegen $\xopt$.
\end{theorem}
